var SimpleAjax=window.SimpleAjax||(function(S){var l={};var m=(function(){var c={};return function(s){return!s?"":c[s]||(c[s]=s.toLowerCase())}})();var r=function(s){var n=document.createElement("div");n.innerHTML=s;return n.firstChild};var t=function(s){var d=document;return!s?s:s.nodeType?s:d.getElementById(s)};S.css=function(n){var w=window.defaultView;S.css=(w&&w.getComputedStyle)?function(n){return w.getComputedStyle(n,null)}:function(n){return n.currentStyle||n.style};return S.css(n)};var u=function(e){e=e||window.event;if(!e.preventDefault){e.preventDefault=function(){e.returnValue=false};e.stopPropagation=function(){e.cancelBubble=true};e.target=e.srcElement;e.relatedTarget=(e.type=="mouseout")?e.toElement:e.fromElement}var a=l[e.type]||l["on"+e.type];var b=e.target;var c,o;do{c=a[m(b.tagName)]||[];z:for(var i=0;i<c.length;i++){var d=c[i].attrs||{};for(var s in d){var f=b.getAttribute(s);if(!f||(d[s]&&d[s].test&&!d[s].test(f))||(d[s]&&d[s]!=f)){continue z}}o=c[i];if(o.func.call(o.ctx,e,o)==true)return}}while((b=b.parentNode))};S.register=function(a,c,d,e,f){if(!l[a]){l[a]={};var b=document;b=b.documentElement||b.body;if(b.addEventListener){b.addEventListener(a.replace(/^on/,""),u,false)}else{b.attachEvent(a,u)}}if(!l[a][c]){l[a][c]=[]}if(!e){e=S.handleEvent;f=S;d=d||{};d.rel=d.rel||0}else if(e in f){e=f[e]}l[a][c].push({attrs:d,tag:c,func:e,ctx:f})};S.handleEvent=function(e){var p=(e.target.getAttribute("rel")||"").split(/\s+/);var a=m(p[0]);if(!/^(get|get-nocache|post|put|delet[e])$/.test(a))return;var b=e.target;var c=y(b)||"";var d=S.getForm(b);var f;switch(p.length){case 1:break;case 2:b=p[1];break;case 3:if(p[1]!="#")c=S.mergeURLs(c,p[1]);b=p[2];break;case 4:if(p[1]!="#")c=S.mergeURLs(c,p[1]);b=p[2];f=p[3];break}if(b=="null")b=0;if(c){e.preventDefault();S.doAction(e,a,c,d,b,f);return true}};S.doAction=function(e,d,f,g,h,i){var j=i||(e&&/click|mousedown|mouseup|submit/.test(e.type));S.getURL(d,f,g,function(a,b,c){if(j)S.setBusy(0,i);if(b){if(h){if(t(h)){S.flash(h,240,function(){S.setNodeValue(h,a)})}else alert("Tag with id '"+f+"' not found.")}}else if(c){alert("Server Error: "+c.status+" "+c.statusText+"\nFor: "+f.replace(/^(.{70}).*$/,"$1..."))}});if(j)S.setBusy(1,i)};var y=function(n){var a=m(n.tagName);if(a=="a"){return n.href}else if(/input|textarea|button|select/.test(a)){n=n.form;return n?n.attributes["action"].value:n}};S.mergeURLs=(function(){var d=function(a,b){b=b||{};a=a.split("?")[1];if(a){var p=a.split("&"),q;for(var i=0;i<p.length;i++){q=p[i].split("=");b[q[0]]=q[1]||""}}return b};var e=function(a){var b=[];for(var i in a)b.push(i+"="+a[i]);return b.join("&")};return function(a,b){var s=b.charAt(0);if(s=="\/"){s=b}else if(s=="?"){var c=e(d(b,d(a)));s=a.split("?")[0]+"?"+c}else{var c=e(d(b,d(a)));a=a.substr(0,a.split("?")[0].lastIndexOf("\/")+1||a.length);s=a+b.split("?")[0]+(c?"?"+c:"")}return s}})();S.getForm=function(n){var a=m(n.tagName);if(/input|button|textarea|select|form/.test(a)&&(a=="form"||n.form)){var o={};if(n.name&&(a=="button"||(a=="input"&&/button|submit|image/i.test(n.type)))){o[n.name]=true}var b=n.form||n;var c=b.elements;for(var i=0;i<c.length;i++){var d=c[i];var e=node.name;if(d.disabled||!e)return;if(/select/i.test(d.tagName)){o[e]=[];for(var j=0;j<d.options.length;j++){var f=d.options[j];if(f.selected)o[e].push(f.value||f.text)}}else if(!/button|submit|reset|image/i.test(d.type)){o[e]=d.value}}return o}};var A=(function(){var c={};return function(s){if(!c[s]){c[s]=document.body.appendChild(r("<scr"+"ipt><\/scr"+"ipt>")).src=s}}})();S.setNodeValue=function(d,e){d=t(d);var f=m(d.tagName);if(/input|textarea/.test(f)){d.value=e}else{var g="";var h=[];e=e.replace(/^<html[^>]*>|<\/html>$/g,"").replace(/<[s]cript([^>]*)>([\S\s]*?)<\/[s]cript>/ig,function(a,b,c){b=/\bdefer\b/i.test(b)?(/src=['"]?([^>'"\s]+)/i.exec(b)||{})[1]:0;if(b){h.push(b)}else{g+=c+";"}return""});var j=function(n,c){var a;while((a=n.firstChild)){c?c.appendChild(a):n.removeChild(a)}};if(f=="img"){d.src=e}else if(f=="select"){j(d);j(r("<select>"+e+"<\/select>"),d)}else if(f=="table"){j(d);j(r("<table>"+e+"<\/table>"),d)}else if(f=="tr"){j(d);j(r("<table><tr>"+e+"<\/tr><\/table>").rows[0],d)}else{d.innerHTML=e}if(g)setTimeout(g,0);for(var i=0;i<h.length;i++){A(h[i])}}};var B={};S.setBusy=function(a,b){if(!b){b=t("simpleajax-busy");if(!b){var d=document;var c=d.body.getAttribute("loading")||"Loading&hellip;";b=r("<div id='simpleajax-busy' style='position:fixed;top:0%;"+"left:50%;margin-left:-80px;padding:3px;background:#fd0;color:#000;"+"font-weight:bold;display:none;opacity:0.8;filter:alpha(opacity=80)'>"+c+"<\/div>");d.body.appendChild(b);var e=b.style;if(e.setExpression&&(!window.XMLHttpRequest||d.compatMode=="BackCompat")){var f=function(s){return"(document.body."+s+"||(document.documentElement||{})."+s+")"};e.setExpression("left",f("scrollLeft")+"+("+f("clientWidth")+"-this.offsetWidth)/2");e.setExpression("top",f("scrollTop"));e.margin="0";e.position="absolute"}}}if(!(b=t(b)))return;var g=b.id||"*";B[g]=(B[g]||0)+(a?1:-1);var h=function(){b.style.display=(B[g]>0)?"":"none"};if(B[g]==1)setTimeout(h,300);else h();if(B[g]>1)S.flash(b,200)};S.flash=function(b,c,d){b=t(b);var e=function(a){return(/alpha\(opacity=(\d+)\)/i.exec(a.filter)||{})[1]/100||a.opacity/1};var f=function(n,v){n=n.style;n.opacity=v;n.filter=v?"alpha(opacity="+Math.round(v*100)+")":"";n.zoom=1};var g=e(b.style)||"";var h=e(S.css(b))||1;var i="noanim";if(b[i]){d()}else{b[i]=1;S.anim(b,h,0,c,f,function(){f(b,g);b[i]=0;d()})}};S.anim=function(b,c,d,e,f,g){var h=new Date().getTime();var P=Math.PI/2;var i=function(){f(b,c);if(c!=d){var a=new Date().getTime()-h;c=(a-e>=40)?d:c+Math.sin(a/e*P)*(d-c);setTimeout(i,40)}else if(g){g(b)}};i()};S.xhrCache={};S.getURL=function(b,c,f,g){b=m(b);if(/^data:/.test(c)){return g(unescape(c.replace(/^data:,?/,"")),1,null)}else if(/^#./.test(c)){var h=t(c.substr(1));return h?g(h.innerHTML,1,null):alert("Tag with id '"+c+"' not found.")}else if(b=="get"&&S.xhrCache[c]){return g(S.xhrCache[c],1,null)}if(b=="get-nocache"){c+=(/\?/.test(c)?"&":"?")+".r="+Math.random()}if(typeof f!="string"&&!(f instanceof String)){var s=[];for(var i in f)s.push(escape(i)+"="+escape(f[i]));f=s.join("&")}if(b=="post"){if(!f){f=c.substr(c.indexOf("?")+1);c=c.split("?")[0]}else{var j=c.substr(c.indexOf("?")+1).split("&");var d="&"+f;for(var i=0;i<j.length;i++){if(d.indexOf("&"+param[i].split("=")[0]+"=")==-1){f+="&"+param[i]}}}}var k=S.getXHR();k.open(b=="get-nocache"?"GET":b.toUpperCase(),c,true);k.setRequestHeader("X-Requested-With","XMLHttpRequest");if(b=="post"){k.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}k.onreadystatechange=function(){if(k.readyState==4){var a=0,v;try{a=k.status;a=((a>=200&&a<300)||a==0||a==304||a==1223);v=k.responseText;if(b=="get")S.xhrCache[c]=v}catch(e){}g(v,a,k)}};try{k.send(f)}catch(e){alert(e.message);throw e;}};S.getXHR=function(){var a=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var i=0;i<a.length;i++){try{var x=a[i]();S.getXHR=a[i];return x}catch(e){}}};(function(){var c=document.documentElement||{};if("onfocusin"in c){var d=new Function("event.srcElement.fireEvent('oncellchange',event);");var e="simpleajax";c.attachEvent("onfocusin",function(){var a=event.srcElement;var b=a.type;if(b&&"value"in a&&!a[e]&&(b=="text"||b=="select-one"||b=="select-multiple")){a[e]={};a.attachEvent("onchange",d)}})}c=0;var f={onclick:[["a",{href:null}],["input",{type:"submit"}],["input",{type:"button"}],["button",{type:"submit"}],["button",{type:"button"}]],onchange:[["input",{type:"text"}],["select"],["textarea"]],oncellchange:[["input",{type:"text"}],["select"],["textarea"]]};for(var i in f){for(var j=0;j<f[i].length;j++){S.register(i,f[i][j][0],f[i][j][1])}}})();return S})({});